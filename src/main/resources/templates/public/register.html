<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaaf.org/">
<head>
    <meta charset="UTF-8">
    <title>Register</title>

    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.4.1/css/bootstrap.min.css"
          th:href="@{/webjars/bootstrap/4.4.1/css/bootstrap.min.css}"
          rel="stylesheet"/>

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.0/jquery.min.js"
            th:src="@{/webjars/jquery/3.5.0/jquery.min.js}"></script>

    <style>
        body {
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            font-size: 14px;
            line-height: 1.428571429;
            color: #333333;
            background-color: rgb(250, 250, 250);
        }
    </style>

</head>

<body>


<h1>注册</h1>


<div id="block" class="container w-25 align-content-center">
    <div class="form">
        <label for="username">用户名</label>
        <input type="text" id="username" required="required" class="form-control"/>
    </div>

    <div class="form">
        <label for="identity">身份证</label>
        <input type="text" id="identity" class="form-control"/>
    </div>

    <div class="form">
        <label for="phone">手机</label>
        <input type="text" id="phone" class="form-control"/>
    </div>

    <div class="form">
        <label for="password">密码</label>
        <input type="password" id="password" class="form-control"/>
    </div>

    <div class="form">
        <label for="passwordTwo">确认密码</label>
        <input type="password" id="passwordTwo" class="form-control"/>
    </div>

    <div class="form" hidden="hidden">
        <label for="credit">角色</label>
        <select id="credit" class="custom-select">
            <option value="user">用户</option>
            <option value="admin">管理</option>
            <option value="tester">测试</option>
        </select>
    </div>

    <br>

    <div align="center">
        <button onclick="register()" class="btn btn-primary">注册</button>

        <button onclick="window.location.href='/login'" class="btn btn-info">返回</button>
    </div>

</div>


<script>
    function register() {
        const username = $("#username").val();
        const identity = $("#identity").val();
        const phone = $("#phone").val();
        const password1 = $("#password").val();
        const password2 = $("#passwordTwo").val();
        const credit = $("#credit").val();

        if (!(username && identity && phone)) {
            alert("请填写所有字段！");
            return;
        }

        if (password1 === password2) {
            $.post("/register", {
                username: username,
                identity: identity,
                phone: phone,
                password: password1,
                credit: credit
            }, function (res) {
                if (res == 1) {
                    alert("注册成功");
                    window.location.href = "/login";
                } else {
                    alert("注册失败！\n身份证/手机/用户名重复");
                }
            });
        } else {
            alert("两次密码不一致！");
        }
    }
</script>

</body>

</html>